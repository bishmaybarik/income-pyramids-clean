/****************************
File: Cleaning File
Author: Bishmay Barik
Purpose: Public Goods
****************************/

// Converting Household Files - CSV
local csv_dir "$raw/income_india_mem"

// Converted Household Files - DTA
local dta_dir "$clean/income_india_mem_dta"

// List of File Names

local files "member_income_20140131_MS_rev member_income_20140228_MS_rev member_income_20140331_MS_rev member_income_20140430_MS_rev member_income_20140531_MS_rev member_income_20140630_MS_rev member_income_20140731_MS_rev member_income_20140831_MS_rev member_income_20140930_MS_rev member_income_20141031_MS_rev member_income_20141130_MS_rev member_income_20141231_MS_rev member_income_20150131_MS_rev member_income_20150228_MS_rev member_income_20150331_MS_rev member_income_20150430_MS_rev member_income_20150531_MS_rev member_income_20150630_MS_rev member_income_20150731_MS_rev member_income_20150831_MS_rev member_income_20150930_MS_rev member_income_20151031_MS_rev member_income_20151130_MS_rev member_income_20151231_MS_rev member_income_20160131_MS_rev member_income_20160229_MS_rev member_income_20160331_MS_rev member_income_20160430_MS_rev member_income_20160531_MS_rev member_income_20160630_MS_rev member_income_20160731_MS_rev member_income_20160831_MS_rev member_income_20160930_MS_rev member_income_20161031_MS_rev member_income_20161130_MS_rev member_income_20161231_MS_rev member_income_20170131_MS_rev member_income_20170228_MS_rev member_income_20170331_MS_rev member_income_20170430_MS_rev member_income_20170531_MS_rev member_income_20170630_MS_rev member_income_20170731_MS_rev member_income_20170831_MS_rev member_income_20170930_MS_rev member_income_20171031_MS_rev member_income_20171130_MS_rev member_income_20171231_MS_rev member_income_20180131_MS_rev member_income_20180228_MS_rev member_income_20180331_MS_rev member_income_20180430_MS_rev member_income_20180531_MS_rev member_income_20180630_MS_rev member_income_20180731_MS_rev member_income_20180831_MS_rev member_income_20180930_MS_rev member_income_20181031_MS_rev member_income_20181130_MS_rev member_income_20181231_MS_rev member_income_20190131_MS_rev member_income_20190228_MS_rev member_income_20190331_MS_rev member_income_20190430_MS_rev member_income_20190531_MS_rev member_income_20190630_MS_rev member_income_20190731_MS_rev member_income_20190831_MS_rev member_income_20190930_MS_rev member_income_20191031_MS_rev member_income_20191130_MS_rev member_income_20191231_MS_rev member_income_20200131_MS_rev member_income_20200229_MS_rev member_income_20200331_MS_rev member_income_20200430_MS_rev member_income_20200531_MS_rev member_income_20200630_MS_rev member_income_20200731_MS_rev member_income_20200831_MS_rev member_income_20200930_MS_rev member_income_20201031_MS_rev member_income_20201130_MS_rev member_income_20201231_MS_rev member_income_20210131_MS_rev member_income_20210228_MS_rev member_income_20210331_MS_rev member_income_20210430_MS_rev member_income_20210531_MS_rev member_income_20210630_MS_rev member_income_20210731_MS_rev member_income_20210831_MS_rev member_income_20210930_MS_rev member_income_20211031_MS_rev member_income_20211130_MS_rev member_income_20211231_MS_rev member_income_20220131_MS_rev member_income_20220228_MS_rev member_income_20220331_MS_rev member_income_20220430_MS_rev member_income_20220531_MS_rev member_income_20220630_MS_rev member_income_20220731_MS_rev member_income_20220831_MS_rev member_income_20220930_MS_rev member_income_20221031_MS_rev member_income_20221130_MS_rev member_income_20221231_MS_rev member_income_20230131_MS_rev member_income_20230228_MS_rev member_income_20230331_MS_rev member_income_20230430_MS_rev member_income_20230531_MS_rev member_income_20230630_MS_rev member_income_20230731_MS_rev member_income_20230831_MS_rev member_income_20230930_MS_rev member_income_20231031_MS_rev member_income_20231130_MS_rev member_income_20231231_MS_rev member_income_20240131_MS_rev member_income_20240229_MS_rev member_income_20240331_MS_rev"

// Loop over each file, import the CSV, and save as .dta
foreach file of local files {
    // Display the current file being processed
    di "Processing `file'.csv"

    // Import the CSV file
    import delimited "`csv_dir'/`file'.csv", clear

    // Save the data as a .dta file
    save "`dta_dir'/`file'.dta", replace
}

di "All files have been processed and saved as .dta files."

********* APPENDING THE DATA ************
* Converting Household Files - CSV
local csv_dir "$raw/income_india_mem"

* Converted Household Files - DTA
local dta_dir "$clean/income_india_mem_dta"

use "$clean/income_india_mem_dta/member_income_20140131_MS_rev.dta", clear
keep hh_id mem_id state hr district region_type stratum psu_id month_slot month response_status nr_reason r_mem_wgt_ms r_mem_wgt_for_country_ms r_mem_wgt_for_state_ms mem_nr_ms mem_nr_for_country_ms mem_nr_for_state_ms mem_status gender age_yrs age_mths relation_with_hoh state_of_origin religion caste caste_category literacy edu nature_of_occupation inc_of_mem_frm_all_srcs inc_of_mem_frm_wages

local files "member_income_20140228_MS_rev member_income_20140331_MS_rev member_income_20140430_MS_rev member_income_20140531_MS_rev member_income_20140630_MS_rev member_income_20140731_MS_rev member_income_20140831_MS_rev member_income_20140930_MS_rev member_income_20141031_MS_rev member_income_20141130_MS_rev member_income_20141231_MS_rev member_income_20150131_MS_rev member_income_20150228_MS_rev member_income_20150331_MS_rev member_income_20150430_MS_rev member_income_20150531_MS_rev member_income_20150630_MS_rev member_income_20150731_MS_rev member_income_20150831_MS_rev member_income_20150930_MS_rev member_income_20151031_MS_rev member_income_20151130_MS_rev member_income_20151231_MS_rev member_income_20160131_MS_rev member_income_20160229_MS_rev member_income_20160331_MS_rev member_income_20160430_MS_rev member_income_20160531_MS_rev member_income_20160630_MS_rev member_income_20160731_MS_rev member_income_20160831_MS_rev member_income_20160930_MS_rev member_income_20161031_MS_rev member_income_20161130_MS_rev member_income_20161231_MS_rev member_income_20170131_MS_rev member_income_20170228_MS_rev member_income_20170331_MS_rev member_income_20170430_MS_rev member_income_20170531_MS_rev member_income_20170630_MS_rev member_income_20170731_MS_rev member_income_20170831_MS_rev member_income_20170930_MS_rev member_income_20171031_MS_rev member_income_20171130_MS_rev member_income_20171231_MS_rev member_income_20180131_MS_rev member_income_20180228_MS_rev member_income_20180331_MS_rev member_income_20180430_MS_rev member_income_20180531_MS_rev member_income_20180630_MS_rev member_income_20180731_MS_rev member_income_20180831_MS_rev member_income_20180930_MS_rev member_income_20181031_MS_rev member_income_20181130_MS_rev member_income_20181231_MS_rev member_income_20190131_MS_rev member_income_20190228_MS_rev member_income_20190331_MS_rev member_income_20190430_MS_rev member_income_20190531_MS_rev member_income_20190630_MS_rev member_income_20190731_MS_rev member_income_20190831_MS_rev member_income_20190930_MS_rev member_income_20191031_MS_rev member_income_20191130_MS_rev member_income_20191231_MS_rev member_income_20200131_MS_rev member_income_20200229_MS_rev member_income_20200331_MS_rev member_income_20200430_MS_rev member_income_20200531_MS_rev member_income_20200630_MS_rev member_income_20200731_MS_rev member_income_20200831_MS_rev member_income_20200930_MS_rev member_income_20201031_MS_rev member_income_20201130_MS_rev member_income_20201231_MS_rev member_income_20210131_MS_rev member_income_20210228_MS_rev member_income_20210331_MS_rev member_income_20210430_MS_rev member_income_20210531_MS_rev member_income_20210630_MS_rev member_income_20210731_MS_rev member_income_20210831_MS_rev member_income_20210930_MS_rev member_income_20211031_MS_rev member_income_20211130_MS_rev member_income_20211231_MS_rev member_income_20220131_MS_rev member_income_20220228_MS_rev member_income_20220331_MS_rev member_income_20220430_MS_rev member_income_20220531_MS_rev member_income_20220630_MS_rev member_income_20220731_MS_rev member_income_20220831_MS_rev member_income_20220930_MS_rev member_income_20221031_MS_rev member_income_20221130_MS_rev member_income_20221231_MS_rev member_income_20230131_MS_rev member_income_20230228_MS_rev member_income_20230331_MS_rev member_income_20230430_MS_rev member_income_20230531_MS_rev member_income_20230630_MS_rev member_income_20230731_MS_rev member_income_20230831_MS_rev member_income_20230930_MS_rev member_income_20231031_MS_rev member_income_20231130_MS_rev member_income_20231231_MS_rev member_income_20240131_MS_rev member_income_20240229_MS_rev member_income_20240331_MS_rev"

* Converted Household Files - DTA
local dta_dir "$clean/income_india_mem_dta"

* Loop over each file, import the CSV, and save as .dta
foreach file of local files {
    
	* Display the current file being processed
    di "Processing `file'"
	append using "`dta_dir'/`file'.dta", keep(hh_id mem_id state hr district region_type stratum psu_id month_slot month response_status nr_reason r_mem_wgt_ms r_mem_wgt_for_country_ms r_mem_wgt_for_state_ms mem_nr_ms mem_nr_for_country_ms mem_nr_for_state_ms mem_status gender age_yrs age_mths relation_with_hoh state_of_origin religion caste caste_category literacy edu nature_of_occupation inc_of_mem_frm_all_srcs inc_of_mem_frm_wages)
}

save "$clean/income_india_mem_dta/member_income_clean.dta", replace
